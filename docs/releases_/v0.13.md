# v0.13 - 2025-11-14

## Breaking Changes 

### Removes Version-Specific Namespace "V1"

Simplify the Api structure and debuggability by removing versioning.

**Impact:** User need to change their usings from `using Csra.V1;` and `using static Csra.V1.Api;` to `using Csra;` and `using static Csra.Api;`

### Introduce a New Node `Services`

Instead of having all Services directly accessible from Csra.Api, they will be bundled together to Csra.Api.Services.

**Impact:** User need to change their usage of any Services to go through the new language.

```c#
// previously 
SetupService.Apply("abc");
// new
Services.Setup.Apply("abc");
```

### Migrate `AlertService.ValidationFail()` into `AlertService.Error()`

In cases where it's not clear whether code is being executed in a validation or a program run context, selecting the correct way to handle errors has been challenging because `AlertService` offered two distinct methods. To simplify this, and to prevent accidental use in the wrong place, the functionality has been merged in a common method that can be used anywhere and will internally decide on the correct handling.

```c#
internal static bool IsTrue(bool condition, string problemReasonResolutionMessage, string argumentName) {
    GetArgumentContext(argumentName, out int argumentIndex, out string messagePrefix);
    if (condition == false) {
        if (string.IsNullOrWhiteSpace(problemReasonResolutionMessage)) {
            AlertService.Error($"{messagePrefix}Provided 'ProblemReasonResolutionMessage' is null.", argumentIndex);
            return false;
        }
        AlertService.Error($"{messagePrefix}{problemReasonResolutionMessage}", argumentIndex);
        return false;
    }
    return true;
}
```

**Impact:** Improved use model - flagging erronous conditions to IG-XL is now uniform for runtime and validation.

## Bug Fixes

### Fix run-time-error in demo projects

Due to UltraFLEX only call in OnProgramLoaded, DemoCSRA and DemoCS caused a run-time-error if only UltraFLEXplus installed.
By removing the unnecessary call, the error no longer comes up.

```c#
// Showcase how to use it in code, vs previous if possible.
```

No more errors when starting the demo programs.

## Improvements

### Clean up Demo Program Flows
- add test group separators
- align test group sequence
- update test numbers
- remove binning - not used in automation

**Impact:** Clear structure and comparability between C#RA, C# and VBT code.

### Fix voltage range handling in `SetForceAndMeter`

Since ApplyLevelsTiming does not configure the voltage range of the power supplies, the voltage range should only be modified when necessary, using the `Modify` test block.

**Impact:** The voltage range will no longer be modified by the user when using method `SetForceAndMeter` in `forceVoltage` mode for DCVI and DCVS instruments. Adjustment of this parameter will be performed exclusively through dedicated configuration blocks, such as `Modify`, or by using the advanced `forceV` method.

### Show list of valid options in case of failing enum argument valiation

Enum values have to be provided as string into test methods. During validation, these strings are parsed into enum values. In case of a fail, now the error message shows all valid options.

```c#
TheLib.Validate.Enum(inputValue, nameof(inputValue), out TLibOutputMode enumValue);

// Argument 'inputValue': Provided value '{inputValue}' could not be found within provided Enum 'TLibOutputMode' - the valid options are 'ForceVoltage, ForceCurrent, HighImpedance'.
```

**Impact:** Improved usability for enum type test method arguments.